package com.httpclient;

import com.alibaba.fastjson.JSONObject;
import org.apache.http.client.fluent.Executor;
import org.apache.http.client.fluent.Request;
import org.apache.http.entity.ContentType;
import org.junit.Test;

import java.io.IOException;
import java.nio.charset.Charset;
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

public class HttpClientTest {
    public static void main(String[] args) throws Exception {
//        String responseStr = Request.Get("http://localhost:8082/simulation/doSimulationTmp")
//                .connectTimeout(100000)
//                .socketTimeout(100000)
//                .execute()
//                .returnContent().asString();
//        System.out.println(responseStr);
        Object obj = new Object();
        ThreadPoolExecutor poolExecutor = new ThreadPoolExecutor(2,2,0L, TimeUnit.MILLISECONDS,new ArrayBlockingQueue<>(4));
        for (int i = 0; i < 6; i++) {
            poolExecutor.execute(()->{
                String responseStr = null;
                try {
                    responseStr = Executor.newInstance()
                            .execute(Request.Get("http://localhost:8082/simulation/doSimulationTmp"))
                            .returnContent()
                            .asString(Charset.forName("UTF-8"));
                } catch (IOException e) {
                    e.printStackTrace();
                }

                System.out.println(responseStr);
            });
        }
        while (Thread.currentThread().isAlive()){
            System.out.println(Thread.currentThread().getState());
        }
    }
    @Test
    public void tt(){
        List<Integer> ipList = new ArrayList<>();
        ipList.add(1);
        ipList.add(2);
        ipList.add(3);
        ipList.add(4);
        ipList.add(5);

        ipList.stream().filter(it->it>2).forEach(System.out::println);


    }

    @Test
    public void testVm2(){
        String json = "{\"appKey\":\"${appKey}\",\"appId\":\"${appId}\",\"metricId\":\"${metricId}\",\"startDate\":\"${startDate}\",\"endDate\":\"${endDate}\"," +
                "\"ldc\":\"${ldc}\",\"filters\":{\"AND\":{\"AND\":[{\"value\":[${ip}],\"key\":\"ip\",\"operator\":\"IN\"}]}},\"group\":\"\",\"unit\":\"\"}";

//        List<String> ipList = new ArrayList<>();
//        ipList.add("10.230.72.2");
//        ipList.add("10.230.69.29");
//        ipList.add("10.230.69.39");
        String ip = "\"10.108.56.39\",\"10.108.57.10\",\"10.108.56.40\",\"10.108.57.35\",\"10.108.57.5\",\"10.108.57.23\",\"10.108.56.12\",\"10.108.57.19\",\"10.108.57.32\",\"10.108.57.41\",\"10.108.56.19\",\"10.108.56.32\",\"10.108.56.47\",\"10.108.56.21\",\"10.108.57.38\",\"10.108.57.7\",\"10.108.57.15\",\"10.108.49.30\",\"10.108.56.46\",\"10.108.57.48\",\"10.108.49.41\",\"10.108.56.37\",\"10.108.57.40\",\"10.108.57.42\",\"10.108.56.34\",\"10.108.57.9\",\"10.108.56.23\",\"10.108.56.10\",\"10.108.57.29\",\"10.108.49.17\",\"10.108.57.12\",\"10.108.56.25\",\"10.108.56.3\",\"10.108.57.17\",\"10.108.57.4\",\"10.108.57.8\",\"10.108.57.34\",\"10.108.57.44\",\"10.108.57.45\",\"10.108.56.48\",\"10.108.56.26\",\"10.108.57.18\",\"10.108.57.30\",\"10.108.56.2\",\"10.108.56.6\",\"10.108.56.13\",\"10.108.57.2\",\"10.108.57.11\",\"10.108.56.42\",\"10.108.57.14\",\"10.108.57.3\",\"10.108.57.38\",\"10.108.56.33\",\"10.108.56.45\",\"10.108.57.37\",\"10.108.57.22\",\"10.108.56.30\",\"10.108.57.43\",\"10.108.57.27\",\"10.108.57.47\",\"10.108.56.4\",\"10.108.57.33\",\"10.108.56.22\",\"10.108.56.14\",\"10.108.56.24\",\"10.108.57.16\",\"10.108.68.145\",\"10.108.68.164\",\"10.108.68.73\",\"10.108.68.47\",\"10.108.54.9\",\"10.108.68.179\",\"10.108.68.14\",\"10.108.68.8\",\"10.108.68.13\",\"10.108.68.50\",\"10.108.68.142\",\"10.108.68.3\",\"10.108.68.181\",\"10.108.40.4\",\"10.108.40.13\",\"10.108.40.58\",\"10.108.40.46\",\"10.108.40.67\",\"10.108.40.12\",\"10.112.28.64\",\"10.112.28.40\",\"10.112.28.121\",\"10.112.28.39\",\"10.112.28.181\",\"10.112.28.207\",\"10.112.28.179\",\"10.112.28.139\",\"10.112.28.73\",\"10.112.28.59\",\"10.112.28.159\",\"10.108.68.141\",\"10.108.49.45\",\"10.108.54.12\",\"10.108.54.4\",\"10.108.40.62\",\"10.108.68.44\",\"10.108.68.174\",\"10.108.68.160\",\"10.108.68.166\",\"10.108.68.41\",\"10.108.68.73\",\"10.112.28.176\",\"10.108.68.144\",\"10.108.49.34\",\"10.108.49.20\",\"10.108.49.43\",\"10.108.40.69\",\"10.108.40.52\",\"10.108.40.51\",\"10.108.49.37\",\"10.108.40.64\",\"10.108.49.39\",\"10.108.49.38\",\"10.108.40.2\",\"10.108.49.23\",\"10.108.40.10\",\"10.108.68.47\",\"10.108.40.57\",\"10.108.40.43\",\"10.112.28.123\",\"10.108.54.11\",\"10.108.49.26\",\"10.108.49.46\",\"10.108.54.8\",\"10.108.49.22\",\"10.108.40.48\",\"10.108.68.22\",\"10.108.40.45\",\"10.108.40.59\",\"10.108.68.51\",\"10.108.68.167\",\"10.108.68.21\",\"10.112.28.125\",\"10.108.68.12\",\"10.108.68.9\",\"10.108.68.175\",\"10.108.68.171\",\"10.112.28.120\",\"10.108.68.173\",\"10.108.68.185\",\"10.108.68.162\",\"10.101.129.116\",\"10.101.129.120\",\"10.94.0.136\",\"10.94.1.85\",\"10.112.20.238\",\"10.112.22.122\",\"10.112.68.65\",\"10.105.1.181\",\"10.105.0.89\",\"10.105.0.33\",\"10.105.46.53\",\"10.105.0.25\",\"10.100.0.106\",\"10.100.128.128\",\"10.100.128.157\",\"10.100.128.160\",\"10.100.1.36\",\"10.100.129.17\",\"10.100.129.41\",\"10.103.3.23\",\"10.94.0.164\",\"10.105.0.86\",\"10.105.114.156\",\"10.105.114.152\",\"10.103.128.75\",\"10.105.114.178\",\"10.94.0.125\",\"10.105.114.193\",\"10.105.114.192\",\"10.112.22.178\",\"10.112.68.246\",\"10.112.22.158\",\"10.112.68.158\",\"10.112.21.255\",\"10.112.22.124\",\"10.112.21.202\",\"10.101.129.110\",\"10.101.129.112\",\"10.101.129.111\",\"10.101.129.114\",\"10.101.129.115\",\"10.101.129.113\",\"10.101.129.118\",\"10.101.129.119\",\"10.101.129.121\",\"10.101.129.122\",\"10.101.129.123\",\"10.101.129.124\",\"10.101.129.125\",\"10.101.129.127\",\"10.101.129.126\",\"10.101.129.128\",\"10.101.129.117\",\"10.101.129.110\",\"10.101.129.112\",\"10.101.129.111\",\"10.101.129.114\",\"10.101.129.115\",\"10.101.129.113\",\"10.101.129.116\",\"10.101.129.120\",\"10.101.129.118\",\"10.101.129.119\",\"10.101.129.121\",\"10.101.129.122\",\"10.101.129.123\",\"10.101.129.124\",\"10.101.129.125\",\"10.101.129.127\",\"10.101.129.126\",\"10.101.129.128\",\"10.101.129.117\",\"10.95.1.72\",\"10.95.1.150\",\"10.105.114.163\",\"10.105.0.32\",\"10.105.0.63\",\"10.100.0.32\",\"10.103.2.97\",\"10.102.0.21\",\"10.100.128.163\",\"10.108.68.2\",\"10.108.68.23\",\"10.100.128.61\",\"10.102.0.16\",\"10.103.1.226\",\"10.103.0.224\",\"10.100.2.33\",\"10.102.0.137\",\"10.103.0.154\",\"10.103.0.229\",\"10.103.1.242\",\"10.105.0.77\",\"10.100.0.153\",\"10.103.0.145\",\"10.105.0.74\",\"10.100.2.31\",\"10.102.0.9\",\"10.103.0.136\",\"10.105.1.134\",\"10.100.0.51\",\"10.102.0.133\",\"10.105.1.76\",\"10.100.0.14\",\"10.103.0.116\",\"10.105.0.4\",\"10.102.0.78\",\"10.100.2.7\",\"10.105.0.81\",\"10.105.0.12\",\"10.105.0.80\",\"10.102.0.30\",\"10.103.1.6\",\"10.100.0.71\",\"10.105.0.17\",\"10.100.0.160\",\"10.100.128.103\",\"10.100.0.6\",\"10.100.0.163\",\"10.100.0.52\",\"10.100.128.23\",\"10.100.129.32\",\"10.100.128.11\",\"10.103.1.225\",\"10.100.128.60\",\"10.100.128.56\",\"10.103.0.238\",\"10.103.1.91\",\"10.103.1.66\",\"10.102.1.9\",\"10.100.128.5\",\"10.100.0.72\",\"10.100.128.119\",\"10.100.0.11\",\"10.100.128.136\",\"10.100.2.36\",\"10.94.0.178\",\"10.108.68.145\",\"10.108.68.164\",\"10.108.68.182\",\"10.108.68.13\",\"10.108.68.52\",\"10.108.68.3\",\"10.108.68.174\",\"10.108.68.51\",\"10.108.68.41\",\"10.108.68.9\",\"10.112.28.149\",\"10.112.28.163\",\"10.112.28.164\",\"10.112.28.177\",\"10.112.28.205\",\"10.112.28.181\",\"10.112.28.201\",\"10.112.28.127\",\"10.112.28.185\",\"10.112.28.193\",\"10.112.28.208\",\"10.112.28.161\",\"10.112.28.139\",\"10.112.28.135\",\"10.112.28.160\",\"10.112.28.34\",\"10.112.28.180\",\"10.112.28.172\",\"10.112.28.30\",\"10.112.28.173\",\"10.112.28.127\",\"10.112.28.208\",\"10.112.28.183\",\"10.112.28.193\",\"10.112.28.172\",\"10.112.28.135\",\"10.112.28.185\",\"10.112.28.161\",\"10.112.28.160\",\"10.112.28.44\",\"10.108.68.14\",\"10.108.68.163\",\"10.108.68.12\",\"10.108.68.169\",\"10.108.68.143\",\"10.108.68.166\",\"10.108.68.6\",\"10.108.68.44\",\"10.108.68.24\",\"10.108.68.57\",\"10.108.68.20\",\"10.112.28.56\",\"10.112.28.205\",\"10.112.28.157\",\"10.108.68.1\",\"10.108.68.16\",\"10.108.68.148\",\"10.108.68.147\",\"10.108.68.11\",\"10.108.68.60\",\"10.108.68.60\",\"10.108.68.56\",\"10.108.68.65\",\"10.108.68.175\",\"10.108.49.36\",\"10.108.49.21\",\"10.108.49.44\",\"10.108.49.16\",\"10.108.54.1\",\"10.108.54.6\",\"10.108.40.5\",\"10.108.54.15\",\"10.108.49.27\",\"10.108.49.40\",\"10.108.54.3\",\"10.108.54.5\",\"10.108.54.2\",\"10.108.49.45\",\"10.108.40.18\",\"10.108.54.12\",\"10.108.54.4\",\"10.108.49.28\",\"10.108.54.14\",\"10.112.28.20\",\"10.108.49.21\",\"10.108.49.44\",\"10.108.49.16\",\"10.108.54.1\",\"10.108.54.6\",\"10.108.49.31\",\"10.108.49.19\",\"10.112.28.187\",\"10.112.28.30\",\"10.108.54.15\",\"10.108.49.35\",\"10.108.49.27\",\"10.108.54.3\",\"10.108.49.25\",\"10.108.49.42\",\"10.108.54.6\",\"10.108.68.152\",\"10.108.68.149\",\"10.108.68.146\",\"10.108.68.153\",\"10.108.68.60\",\"10.108.68.140\",\"10.108.68.17\",\"10.108.68.157\",\"10.108.68.17\",\"10.108.68.158\",\"10.112.28.168\",\"10.112.28.175\",\"10.112.28.34\",\"10.112.28.52\",\"10.112.28.147\",\"10.108.68.2\",\"10.108.68.179\",\"10.108.68.180\",\"10.108.68.177\",\"10.108.68.192\",\"10.108.68.186\",\"10.108.68.186\",\"10.108.68.19\",\"10.108.68.7\",\"10.108.68.4\",\"10.108.68.5\",\"10.108.68.50\",\"10.108.68.23\",\"10.108.68.159\",\"10.108.68.1\",\"10.108.68.15\",\"10.108.68.11\",\"10.108.68.16\",\"10.108.68.10\",\"10.108.68.168\",\"10.108.68.69\",\"10.108.68.75\",\"10.108.68.6\",\"10.108.68.153\",\"10.108.68.65\",\"10.112.28.47\",\"10.112.28.69\",\"10.112.28.167\",\"10.112.28.191\",\"10.112.28.149\",\"10.112.28.192\",\"10.112.28.195\",\"10.112.28.18\",\"10.112.28.68\",\"10.112.28.53\",\"10.112.28.74\",\"10.112.28.162\",\"10.112.28.70\",\"10.112.28.41\",\"10.112.28.196\",\"10.108.68.151\",\"10.108.68.180\",\"10.108.68.181\",\"10.108.68.184\",\"10.108.68.178\",\"10.108.68.159\",\"10.112.28.31\",\"10.112.28.174\",\"10.112.28.49\",\"10.112.28.177\",\"10.112.28.180\",\"10.112.28.200\",\"10.112.28.27\",\"10.112.28.57\",\"10.112.28.184\",\"10.112.28.37\",\"10.112.28.19\",\"10.112.28.16\",\"10.112.28.67\",\"10.112.28.178\",\"10.112.28.14\",\"10.112.28.205\",\"10.112.28.137\",\"10.112.28.22\",\"10.112.28.179\",\"10.112.28.35\",\"10.112.28.163\",\"10.112.28.157\",\"10.112.28.59\",\"10.112.28.123\",\"10.112.28.36\",\"10.112.28.187\",\"10.112.28.202\",\"10.112.28.126\",\"10.112.28.15\",\"10.112.28.25\",\"10.112.28.32\",\"10.112.28.32\",\"10.112.28.17\",\"10.112.28.26\",\"10.112.28.131\",\"10.112.28.26\",\"10.112.28.165\",\"10.112.28.155\",\"10.112.28.164\",\"10.112.28.124\",\"10.112.28.52\",\"10.112.28.143\",\"10.112.28.145\",\"10.112.28.158\",\"10.112.28.209\",\"10.112.28.173\",\"10.112.28.13\",\"10.112.28.13\",\"10.112.28.132\",\"10.112.28.190\",\"10.112.28.133\",\"10.112.28.194\",\"10.112.28.194\",\"10.112.28.201\",\"10.112.28.201\",\"10.112.28.54\",\"10.112.28.144\",\"10.112.28.150\",\"10.112.28.140\",\"10.112.28.154\",\"10.112.28.12\",\"10.112.28.197\",\"10.112.28.43\",\"10.112.28.58\",\"10.112.28.55\",\"10.112.28.60\",\"10.112.28.61\",\"10.112.28.199\",\"10.112.28.127\",\"10.112.28.129\",\"10.112.28.62\",\"10.112.28.63\",\"10.112.28.151\",\"10.112.28.182\",\"10.112.28.186\",\"10.112.28.125\",\"10.112.28.27\",\"10.112.28.206\",\"10.112.28.152\",\"10.112.28.21\",\"10.112.28.23\",\"10.112.28.75\",\"10.112.28.135\",\"10.112.28.136\",\"10.112.28.138\",\"10.112.28.130\",\"10.112.28.29\",\"10.112.28.100\",\"10.112.28.130\",\"10.112.28.119\",\"10.112.28.112\",\"10.112.28.156\",\"10.112.28.50\",\"10.112.28.24\",\"10.112.28.38\",\"10.112.28.188\",\"10.112.28.120\",\"10.112.28.101\",\"10.112.28.101\",\"10.112.28.101\",\"10.112.28.207\",\"10.112.28.99\",\"10.112.28.102\",\"10.112.28.208\",\"10.112.28.51\",\"10.112.28.71\",\"10.112.28.128\",\"10.112.28.203\",\"10.112.28.44\",\"10.112.28.170\",\"10.112.28.171\",\"10.112.28.185\",\"10.112.28.193\",\"10.112.28.121\",\"10.112.28.169\",\"10.112.28.169\",\"10.112.28.118\",\"10.112.28.113\",\"10.112.28.114\",\"10.112.28.115\",\"10.112.28.116\",\"10.112.28.189\",\"10.112.28.189\",\"10.112.28.39\",\"10.112.28.40\",\"10.112.28.103\",\"10.112.28.155\",\"10.112.28.204\",\"10.112.28.71\",\"10.112.28.206\",\"10.112.28.131\",\"10.112.28.51\",\"10.112.28.140\",\"10.112.28.61\",\"10.112.28.186\",\"10.112.28.60\",\"10.112.28.154\",\"10.112.28.198\",\"10.112.28.147\",\"10.112.28.190\",\"10.112.28.55\",\"10.112.28.175\",\"10.112.28.166\",\"10.112.28.63\",\"10.112.28.137\",\"10.112.28.54\",\"10.112.28.165\",\"10.112.28.69\",\"10.112.28.168\",\"10.112.28.72\",\"10.108.68.155\",\"10.108.68.185\",\"10.108.68.165\",\"10.108.68.149\",\"10.108.68.161\",\"10.108.68.195\",\"10.108.68.151\",\"10.108.68.24\",\"10.108.68.78\",\"10.108.68.190\",\"10.108.68.188\",\"10.108.68.18\",\"10.108.68.8\",\"10.108.68.58\",\"10.108.68.10\",\"10.108.68.5\",\"10.108.68.21\",\"10.108.68.68\",\"10.108.68.4\",\"10.108.68.74\",\"10.108.68.7\",\"10.108.68.18\",\"10.108.68.72\",\"10.112.220.192\",\"10.112.220.138\",\"10.112.28.152\",\"10.112.28.62\",\"10.112.28.119\",\"10.112.28.171\",\"10.112.28.118\",\"10.112.28.170\",\"10.112.28.57\",\"10.112.28.203\",\"10.112.28.167\",\"10.112.28.151\",\"10.112.28.53\",\"10.112.28.100\",\"10.112.28.68\",\"10.112.28.116\",\"10.112.28.182\",\"10.112.28.150\",\"10.112.28.209\",\"10.112.28.144\",\"10.112.28.67\",\"10.112.28.115\",\"10.112.28.58\",\"10.112.28.114\",\"10.112.28.199\",\"10.112.28.143\",\"10.112.28.197\",\"10.112.28.138\",\"10.112.28.112\",\"10.112.28.158\",\"10.112.28.113\",\"10.112.28.74\",\"10.112.28.136\",\"10.112.28.196\",\"10.112.28.156\",\"10.112.28.192\",\"10.112.28.24\",\"10.112.28.41\",\"10.112.28.29\",\"10.112.28.73\",\"10.112.28.145\",\"10.112.28.191\",\"10.112.28.132\",\"10.112.28.184\",\"10.112.28.23\",\"10.112.28.48\",\"10.112.28.21\",\"10.112.28.66\",\"10.112.28.28\",\"10.112.28.49\",\"10.112.28.141\",\"10.112.28.19\",\"10.112.28.200\",\"10.112.28.65\",\"10.112.28.195\",\"10.112.28.64\",\"10.112.28.148\",\"10.112.28.17\",\"10.112.28.134\",\"10.112.28.15\",\"10.112.28.174\",\"10.112.28.46\",\"10.112.28.202\",\"10.112.28.47\",\"10.112.28.133\",\"10.112.28.14\",\"10.112.28.126\",\"10.112.28.25\",\"10.112.28.56\",\"10.112.28.18\",\"10.112.28.20\",\"10.112.28.70\",\"10.108.56.16\",\"10.108.56.15\",\"10.108.56.11\",\"10.108.56.8\",\"10.108.56.7\",\"10.108.56.1\",\"10.108.56.35\",\"10.108.56.35\",\"10.108.56.27\",\"10.108.56.27\",\"10.108.56.17\",\"10.108.56.17\",\"10.108.56.9\",\"10.108.56.9\",\"10.108.56.5\",\"10.108.56.5\",\"10.108.68.71\",\"10.108.68.71\",\"10.108.68.71\",\"10.108.68.69\",\"10.108.68.66\",\"10.108.68.66\",\"10.108.68.66\",\"10.108.68.58\",\"10.108.68.57\",\"10.108.68.57\",\"10.108.68.78\",\"10.108.68.78\",\"10.108.68.78\",\"10.108.68.62\",\"10.108.68.62\",\"10.108.68.62\",\"10.108.239.22\",\"10.108.239.16\",\"10.108.239.14\",\"192.168.190.246\",\"192.168.190.195\",\"192.168.190.193\",\"192.168.190.192\",\"192.168.190.190\",\"10.108.239.15\",\"10.108.239.15\",\"192.168.190.192\",\"10.108.239.55\",\"192.168.190.193\",\"192.168.190.21\",\"192.168.190.246\",\"192.168.190.196\",\"192.168.190.137\",\"192.168.190.197\",\"192.168.190.177\",\"10.108.239.56\",\"192.168.190.191\",\"192.168.190.22\",\"192.168.190.161\",\"192.168.190.163\",\"192.168.190.181\",\"192.168.190.168\",\"192.168.190.218\",\"10.108.68.77\",\"10.108.68.76\",\"10.108.68.75\",\"10.108.68.74\",\"10.108.68.72\",\"10.108.68.70\",\"10.108.68.69\",\"10.108.68.68\",\"10.108.68.66\",\"10.108.68.65\",\"10.108.68.64\",\"10.108.68.62\",\"10.108.68.57\",\"192.168.190.176\",\"10.108.239.56\",\"192.168.190.178\",\"192.168.190.220\",\"192.168.190.205\",\"192.168.190.185\",\"192.168.190.184\",\"192.168.190.175\",\"10.108.239.53\",\"10.108.239.18\",\"10.108.239.17\",\"192.168.190.227\",\"192.168.190.226\",\"192.168.190.191\",\"192.168.190.22\",\"192.168.190.13\",\"192.168.190.23\",\"10.108.239.21\",\"192.168.190.157\",\"10.108.239.23\",\"192.168.190.207\",\"192.168.190.21\",\"192.168.190.159\",\"192.168.190.138\",\"192.168.190.164\",\"192.168.190.190\",\"192.168.190.208\",\"10.108.239.14\",\"10.108.239.15\",\"192.168.190.20\",\"192.168.190.154\",\"10.108.239.20\",\"192.168.190.189\",\"10.108.239.54\",\"192.168.190.155\",\"192.168.190.209\",\"192.168.190.160\",\"192.168.190.211\",\"10.108.239.55\",\"192.168.190.197\",\"192.168.190.162\",\"192.168.190.183\",\"192.168.190.161\",\"192.168.190.172\",\"192.168.190.174\",\"192.168.190.219\",\"192.168.190.196\",\"192.168.190.165\",\"192.168.190.166\",\"192.168.190.217\",\"192.168.190.187\",\"192.168.190.186\",\"192.168.190.140\",\"192.168.190.188\",\"192.168.190.139\",\"10.108.239.20\",\"192.168.190.216\",\"192.168.190.212\",\"192.168.190.182\",\"10.108.239.23\",\"192.168.190.179\",\"192.168.190.134\",\"192.168.190.167\",\"192.168.190.215\",\"192.168.190.176\",\"192.168.190.213\",\"192.168.190.158\",\"192.168.190.173\",\"10.108.239.21\",\"10.108.239.16\",\"10.104.168.112\",\"10.104.168.111\",\"10.104.168.118\",\"10.104.168.117\",\"10.104.168.101\",\"10.104.168.116\",\"10.104.168.100\",\"10.104.168.115\",\"10.104.168.99\",\"10.104.168.114\",\"10.104.168.98\",\"10.104.168.113\",\"10.104.168.97\",\"10.104.168.112\",\"10.104.168.111\",\"10.104.168.118\",\"10.104.168.117\",\"10.104.168.101\",\"10.104.168.116\",\"10.104.168.100\",\"10.108.68.63\",\"10.108.68.193\",\"10.108.68.71\",\"10.108.68.194\",\"10.108.68.67\",\"10.108.68.189\",\"10.108.68.61\",\"10.108.68.197\",\"10.108.68.59\",\"10.108.68.191\",\"10.108.68.58\",\"10.108.68.196\",\"10.108.68.75\",\"10.108.68.187\",\"10.108.68.70\",\"10.108.68.190\",\"10.108.68.64\",\"10.108.68.195\",\"10.108.68.77\",\"10.108.68.188\",\"10.108.68.63\",\"10.108.68.193\",\"10.108.68.71\",\"10.108.68.194\",\"10.108.68.67\",\"10.108.68.189\",\"10.108.68.61\",\"10.108.68.197\",\"10.108.68.59\",\"10.108.68.191\",\"10.108.68.58\",\"10.108.68.196\",\"10.108.57.120\",\"10.108.57.101\",\"10.108.57.119\",\"10.108.57.96\",\"10.108.57.128\",\"10.108.57.93\",\"10.108.57.118\",\"10.108.57.91\",\"10.108.57.137\",\"10.108.57.90\",\"10.108.57.112\",\"10.108.57.89\",\"10.108.57.136\",\"10.108.57.88\",\"10.108.57.111\",\"10.108.57.87\",\"10.108.57.135\",\"10.108.57.86\",\"10.108.57.110\",\"10.108.57.85\",\"10.108.57.134\",\"10.108.57.83\",\"10.108.57.109\",\"10.108.57.107\",\"10.108.57.133\",\"10.108.57.100\",\"10.108.57.117\",\"10.108.57.99\",\"10.108.57.132\",\"10.108.57.81\",\"10.108.57.116\",\"10.108.57.98\",\"10.108.57.131\",\"10.108.57.80\",\"10.108.57.115\",\"10.108.57.97\",\"10.108.57.130\",\"10.108.57.92\",\"10.108.57.114\",\"10.108.57.104\",\"10.108.57.129\",\"10.108.57.84\",\"10.108.57.113\",\"10.108.57.82\",\"10.108.57.108\",\"10.94.2.32\",\"10.94.1.119\",\"10.94.2.8\",\"10.108.68.127\",\"10.108.68.125\",\"10.108.68.80\",\"10.108.68.124\",\"10.108.68.104\",\"10.108.68.123\",\"10.108.68.26\",\"10.108.68.139\",\"10.108.68.26\",\"10.108.68.135\",\"10.108.68.33\",\"10.108.68.120\",\"10.108.68.82\",\"10.108.68.119\",\"10.108.68.91\",\"10.108.68.118\",\"10.108.68.104\",\"10.108.68.134\",\"10.108.68.45\",\"10.108.68.117\",\"10.108.68.31\",\"10.108.68.133\",\"10.108.68.34\",\"10.108.68.116\",\"10.108.68.42\",\"10.108.68.132\",\"10.108.68.80\",\"10.108.68.131\",\"10.108.68.135\",\"10.95.0.6\",\"10.95.0.114\",\"10.95.0.62\",\"10.95.0.102\",\"10.95.0.81\",\"10.95.0.94\",\"10.95.0.32\",\"10.95.0.100\",\"10.95.0.28\",\"10.95.0.120\",\"10.95.0.84\",\"10.95.0.113\",\"10.103.0.210\",\"10.103.3.26\",\"10.108.68.23\",\"10.108.68.140\",\"10.108.68.163\",\"10.108.68.173\",\"10.108.68.162\",\"10.108.68.146\",\"10.108.68.16\",\"10.108.68.19\",\"10.108.68.147\",\"10.108.68.148\",\"10.108.68.143\",\"10.108.68.20\",\"10.108.68.172\",\"10.108.68.161\",\"10.108.68.171\",\"10.108.68.160\",\"10.108.68.170\",\"10.108.68.169\",\"10.108.68.168\",\"10.108.68.167\",\"10.108.68.64\",\"10.108.68.154\",\"10.108.68.60\",\"10.108.68.56\",\"10.108.68.147\",\"10.108.68.77\",\"10.108.68.74\",\"10.108.68.148\",\"10.108.68.70\",\"10.108.68.141\",\"10.108.68.70\",\"10.108.68.59\",\"10.108.68.15\",\"10.108.68.148\",\"10.108.68.76\",\"10.108.68.64\",\"10.108.68.69\",\"10.108.68.75\",\"10.108.68.142\",\"10.108.68.150\",\"10.108.68.157\",\"10.108.68.150\",\"10.108.68.150\",\"10.108.68.158\",\"10.108.68.152\",\"10.108.68.152\",\"10.108.68.156\",\"10.108.68.154\",\"10.108.68.156\",\"10.108.68.155\",\"10.94.1.172\",\"10.94.1.148\",\"10.94.1.106\",\"10.94.2.51\",\"10.94.1.218\",\"10.94.1.94\",\"10.94.1.241\",\"10.94.1.254\",\"10.94.1.246\",\"10.94.1.223\",\"10.94.1.213\",\"10.94.1.212\",\"10.94.1.125\",\"10.94.1.192\",\"10.94.1.174\",\"10.94.1.162\",\"10.94.1.240\",\"10.94.1.110\",\"10.94.2.20\",\"10.94.1.138\",\"10.94.1.137\",\"10.94.1.132\",\"10.94.1.195\",\"10.94.1.156\",\"10.94.2.39\",\"10.94.2.57\",\"192.168.19.213\",\"10.104.38.46\",\"192.168.19.166\",\"192.168.19.83\",\"10.108.57.21\",\"10.108.57.24\",\"10.108.57.15\",\"10.108.57.7\",\"10.108.57.13\",\"10.108.57.39\",\"10.108.57.25\",\"10.108.57.28\",\"10.108.57.36\",\"10.108.57.26\",\"10.100.1.5\",\"10.100.0.44\",\"10.108.40.77\",\"10.108.40.80\",\"10.108.40.87\",\"10.105.1.115\",\"10.105.1.128\",\"192.168.190.172\",\"192.168.190.162\",\"192.168.190.177\",\"192.168.190.210\",\"192.168.190.219\",\"192.168.190.168\",\"192.168.190.181\",\"192.168.190.206\",\"192.168.190.138\",\"192.168.190.20\",\"10.108.40.53\",\"10.108.40.60\"";
//        StringBuilder ipSb = new StringBuilder();
//        for (int i = 0; i < ipList.size(); i++) {
//            if (i == ipList.size() - 1) {
//                ipSb.append("\"").append(ipList.get(i)).append("\"");
//            }else {
//                ipSb.append("\"").append(ipList.get(i)).append("\"").append(",");
//            }
//        }
//        ip = ipSb.toString();
//        System.out.println("**************************************************");
//        System.out.println(ip);
//        System.out.println("**************************************************");
//

        String appKey = "59920732cd3a43f28e48f8f42514da5a";
        String appId = "FIAAS";
        String metricId = "468";
        String startDate = "2021-06-02 01:05:51";
        String endDate = "2021-06-02 01:05:51";
        String ldc = "NJYH";

        String request = json.replace("${appKey}",appKey).replace("${metricId}",metricId).replace("${ldc}",ldc)
                .replace("${appId}",appId).replace("${startDate}",startDate).replace("${endDate}",endDate).replace("${ip}",ip);
        String promesUrl = "http://ctmodp.cnsuning.com/api/services/metrics";
        System.out.println("**************************************************");
        for (int i = 0; i < 50; i++) {
            Long start = System.currentTimeMillis();
            httpFluentPost(promesUrl,request);
            Long end = System.currentTimeMillis()-start;

            System.out.println(i + " 耗时 ： " + end + " ms。");
        }


    }

    @Test
    public void testVm(){
        String json = "{\"appKey\":\"${appKey}\",\"appId\":\"${appId}\",\"metricId\":\"${metricId}\",\"startDate\":\"${startDate}\",\"endDate\":\"${endDate}\"," +
                "\"ldc\":\"${ldc}\",\"filters\":{\"AND\":{\"AND\":[{\"value\":[\"${ip}\"],\"key\":\"ip\",\"operator\":\"IN\"}]}},\"group\":\"\",\"unit\":\"\"}";

        String appKey = "59920732cd3a43f28e48f8f42514da5a";
        String appId = "FIAAS";
        String metricId = "435";
        String startDate = "2021-06-02 01:05:51";
        String endDate = "2021-06-02 01:05:51";
        String ldc = "NJYH";
        String ip  = "10.230.72.2";
        String request = json.replace("${appKey}",appKey).replace("${metricId}",metricId).replace("${ldc}",ldc)
                .replace("${appId}",appId).replace("${startDate}",startDate).replace("${endDate}",endDate).replace("${ip}",ip);
        String promesUrl = "http://ctmodp.cnsuning.com/api/services/metrics";
        System.out.println(request);
        System.out.println("**************************************************");

        System.out.println(httpFluentPost(promesUrl,request));

    }



    @Test
    public void testHost(){
        String json = "{\"appKey\":\"${appKey}\",\"appId\":\"${appId}\",\"metricId\":\"${metricId}\",\"startDate\":\"${startDate}\",\"endDate\":\"${endDate}\"," +
                "\"ldc\":\"${ldc}\",\"filters\":{\"AND\":{\"AND\":[{\"value\":[\"${ip}\"],\"key\":\"ip\",\"operator\":\"IN\"}]}},\"group\":\"\",\"unit\":\"\"}";

        String appKey = "59920732cd3a43f28e48f8f42514da5a";
        String appId = "FIAAS";
        String metricId = "468";
        String startDate = "2021-06-02 01:05:51";
        String endDate = "2021-06-02 01:05:51";
        String ldc = "NJYH";
        String ip  = "10.112.204.78";
        String request = json.replace("${appKey}",appKey).replace("${metricId}",metricId).replace("${ldc}",ldc)
                .replace("${appId}",appId).replace("${startDate}",startDate).replace("${endDate}",endDate).replace("${ip}",ip);
        String promesUrl = "http://ctmodp.cnsuning.com/api/services/metrics";
        System.out.println(request);
        System.out.println("**************************************************");

        System.out.println(httpFluentPost(promesUrl,request));

    }

    public static String getIps(){

        return "";
    }

    @Test
    public void resultConvert(){
        String result = "{\"code\":1,\"message\":\"成功\",\"data\":{\"data\":{\"columns\":[{\"name\":\"time\",\"type\":\"\"},{\"name\":\"value\",\"type\":\"\"},{\"name\":\"exported_ip\",\"type\":\"\"},{\"name\":\"instance\",\"type\":\"\"},{\"name\":\"cpuid\",\"type\":\"\"},{\"name\":\"ldcId\",\"type\":\"\"},{\"name\":\"ip\",\"type\":\"\"},{\"name\":\"env\",\"type\":\"\"},{\"name\":\"firstCenterName\",\"type\":\"\"},{\"name\":\"type\",\"type\":\"\"},{\"name\":\"collectUrl\",\"type\":\"\"},{\"name\":\"slave\",\"type\":\"\"},{\"name\":\"exporter\",\"type\":\"\"},{\"name\":\"hostname\",\"type\":\"\"},{\"name\":\"appId\",\"type\":\"\"},{\"name\":\"job\",\"type\":\"\"},{\"name\":\"secondCenterName\",\"type\":\"\"}],\"rows\":[[1621829550,0.76,\"10.112.200.152\",\"10.112.200.152:8000\",\"cpu\",\"NJYH\",\"10.112.200.152\",\"PRD\",\"基础云研发中心\",\"idle\",\"http://10.112.200.152:8000/metrics\",\"10.105.236.30\",\"indicators_exporter\",\"jbo02n010112200152.sncloud.com\",\"OPENSTACK\",\"standard\",\"存储产品研发中心\"]]}}}";
        JSONObject response = JSONObject.parseObject(result);
        double rateDouble = response.getJSONObject("data").getJSONObject("data").getJSONArray("rows").getJSONArray(0).getDouble(1) * 100;
        System.out.println(rateDouble);
    }

    public static String httpFluentPost(String promesUrl, String request) {
        String result = "";
        try {
            result = Executor.newInstance()
                    .execute(Request.Post(promesUrl).bodyString(request, ContentType.APPLICATION_JSON))
                    .returnContent()
                    .asString(Charset.defaultCharset());
            return result;
        } catch (IOException e) {
            return result;
        }finally {
            Executor.closeIdleConnections();
        }
    }
}
